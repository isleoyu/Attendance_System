# 功能規格說明

## 核心功能模組

### 1. 打卡模組 (Phase 1 ✅)

#### 1.1 彈性放休打卡
- 員工可在工作期間多次開始/結束休息
- 系統自動記錄每次休息的開始與結束時間
- 休息時間自動從工時中扣除
- 支援不同休息類型：一般休息、用餐、私事、緊急

#### 1.2 打卡狀態管理
| 狀態 | 說明 | 可執行動作 |
|------|------|-----------|
| NOT_CLOCKED_IN | 未打卡 | 上班打卡 |
| WORKING | 工作中 | 開始休息、下班打卡 |
| ON_BREAK | 休息中 | 結束休息 |
| CLOCKED_OUT | 已下班 | 第二段上班 (分段班) |

#### 1.3 工時計算
- 自動計算總工時、休息時間、淨工時
- 對照排班計算加班時數
- 異常情況自動標記需審核
- 支援分段班的工時合併計算

#### 1.4 多店鋪打卡
- 員工可關聯多間店鋪
- 打卡時記錄實際打卡店鋪
- 支援跨店輪調的出勤記錄

---

### 2. 排班模組 (Phase 2 🔲)

#### 2.1 班別設定
- 定義各種班別（早班、晚班、分段班）
- 設定班別時間、預設休息時長、最大休息次數
- 分段班可設定中間休息時段

#### 2.2 排班管理
- 拖拉式排班日曆介面
- 批次排班功能
- 排班發布與通知
- 排班衝突檢測

#### 2.3 排班產生器
- 根據人力需求自動產生建議排班
- 考慮員工可用性、休息間隔
- 公平性分配原則

---

### 3. 審核模組 (Phase 3 🔲)

#### 3.1 審核類型
| 類型 | 觸發條件 | 審核權限 |
|------|----------|----------|
| 出勤調整 | 異常打卡記錄 | 組長、店長 |
| 加班審核 | 加班超過閾值 | 店長 |
| 請假申請 | 員工提交請假 | 組長、店長 |
| 排班變更 | 排班修改請求 | 店長 |

#### 3.2 審核流程
```
員工提交 → 組長審核 → (需要時) 店長審核 → 完成
                ↓
            駁回 → 通知員工
```

#### 3.3 權限分級
| 角色 | 可審核項目 | 加班上限 | 請假上限 |
|------|-----------|---------|---------|
| SHIFT_LEADER | 出勤調整 | 60分鐘 | 1天 |
| STORE_MANAGER | 全部 | 480分鐘 | 14天 |
| SUPER_ADMIN | 全部 | 無限 | 無限 |

---

### 4. 薪資模組 (Phase 4 🔲)

#### 4.1 薪資計算
- 基本時薪 × 正常工時
- 加班費率 (1.33x / 1.66x)
- 假日加班費率 (2x)
- 夜班津貼

#### 4.2 薪資報表
- 依員工、依店鋪、依期間查詢
- 匯出 Excel/PDF
- 薪資條產生

---

### 5. 報表模組 (Phase 5 🔲)

#### 5.1 出勤報表
- 個人出勤明細
- 部門出勤統計
- 異常出勤列表

#### 5.2 工時報表
- 工時統計 (日/週/月)
- 加班時數統計
- 休息時間分析

---

## 使用者角色與權限

| 功能 | 員工 | 組長 | 店長 | 管理員 |
|------|------|------|------|--------|
| 打卡 | ✅ | ✅ | ✅ | ✅ |
| 查看自己出勤 | ✅ | ✅ | ✅ | ✅ |
| 查看自己排班 | ✅ | ✅ | ✅ | ✅ |
| 申請請假 | ✅ | ✅ | ✅ | ✅ |
| 查看團隊出勤 | ❌ | ✅ | ✅ | ✅ |
| 審核出勤 | ❌ | ✅ | ✅ | ✅ |
| 管理排班 | ❌ | ❌ | ✅ | ✅ |
| 審核請假 | ❌ | ✅ | ✅ | ✅ |
| 員工管理 | ❌ | ❌ | ✅ | ✅ |
| 店鋪設定 | ❌ | ❌ | ❌ | ✅ |
| 薪資計算 | ❌ | ❌ | ✅ | ✅ |

---

## 餐飲業特殊需求

### 彈性放休
餐飲業因用餐尖峰時段不固定，員工休息時間彈性較大：
- 不限定固定休息時間
- 可分多次休息
- 系統自動追蹤總休息時間
- 超時休息自動標記

### 分段班制
餐廳常見的分段班（早午餐 + 晚餐）：
- 10:00-14:00 (第一段)
- 14:00-17:00 (分段休息，不計薪)
- 17:00-21:00 (第二段)

### 多店支援
連鎖餐飲品牌的跨店調度：
- 員工可在授權店鋪打卡
- 出勤記錄自動歸屬實際打卡店鋪
- 薪資可按店鋪或合併計算
